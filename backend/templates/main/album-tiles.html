<!-- templates/app/album_tiles.html -->

{% comment %}{% extends 'base.html' %}{% endcomment %}

{% block header %}
<style>
    .tile-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 20px;
        padding: 20px 0; 
    }

    .tile-item {
        border: none;
        border-radius: 8px;
        overflow: hidden;
        transition: transform 0.2s;
        text-align: center;
    }

    .tile-item img {
        width: 100%;
        height: 200px;
        object-fit: cover;
        display: block;
    }

    .album-image {
        background: var(--bg-sidebar);
        background-size: cover;
    }

    .tile-info {
        padding-left: 15px;
        padding-right: 15px;
        padding-bottom: 10px;
        background-color: var(--bg-content);
    }

    .tile-info p {
        margin: 0;
        color: var(--tile-info-text);
        font-size: 0.9em;
    }

    h3.album-name {
        margin: 0 0 5px 0;
        font-size: 16px !important;   
        padding-bottom: 8px;
        height: 18px;
        overflow: hidden;
    }

</style>
{% endblock %}

{% block search %}
    <input type="text" id="searchInput" class="searchInput" placeholder="Filtrar álbumes..." onkeyup="clearTimeout(this.searchTimeout); this.searchTimeout = setTimeout(triggerSearch, 300);">
{% endblock %}


<h1 class="shadowed">Álbumes (<span id="album-count">{{ albums.count }}</span>)</h1>


{% block content %}

<div id="loading" style="display: none;">Cargando albumes...</div>

<div class="tile-container" id="tileContainer">
    
</div>

<script>
    console.log("REACH");
    loadAlbums();

    const container = document.getElementById('tileContainer');
    const scrollbox = document.getElementsByClassName('main-content')[0];
    const loadingIndicator = document.getElementById('loading');
    const countDisplay = document.getElementById('album-count');

    // Carga inicial y listeners
    // window.addEventListener('DOMContentLoaded', (event) => {
        scrollbox.addEventListener('scroll', handleScroll);
        
        searchInput.addEventListener('input', () => {
            // Usamos un pequeño retardo (debounce) para no saturar el servidor con peticiones
            
        });

        triggerSearch(); 
        alert("OK");
    // });
    
</script>

{% endblock %}
