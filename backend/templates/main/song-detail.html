{% extends 'base.html' %}
{% load static %}

{% block header %}

{% endblock %}

{% block content %}
<div class="song-detail-container">
    <h1>{{ song.title }}</h1>
    
    <p>
        <strong>Duración:</strong> 
        {{ song.duration }}
    </p>

    <div class="album-info-section">
        <h3>Perteneciente al Álbum:</h3>
        
        <!-- Accedemos al objeto Album relacionado directamente -->
        <a href="{% url 'album-detail' song.album.pk %}">
            <img src="{{ song.album.picture }}" alt="Portada de {{ song.album.name }}" style="width: 150px;">
            <h4>{{ song.album.name }}</h4>
        </a>

        <!-- Accedemos a los artistas del álbum relacionado -->
        <p>
            <strong>Artistas Principales:</strong>
            {% for artist in song.album.artists.all %}
                <a href="{% url 'artist-detail' artist.pk %}">{{ artist.name }}</a>{% if not forloop.last %}, {% endif %}
            {% endfor %}
        </p>
        <!-- El reproductor de audio -->
        <p>
            {% if song.filename %}
                <div class="audio-player-container">
                    <!-- 
                        La etiqueta <audio> de HTML5 
                        'controls' añade los botones de play/pausa
                        'preload="none"' ayuda a que no se carguen todas las canciones a la vez
                    -->
                    <audio controls preload="none">
                        <!-- Usamos .url para obtener la URL pública del archivo -->
                        <source src="{% static song.filename %}" type="audio/mpeg">
                        Tu navegador no soporta el elemento de audio.
                    </audio>
                </div>
            {% else %}
                <span class="no-track-available">Pista no disponible</span>
            {% endif %}
        </p>
    </div>

    <a href="{% url 'album-detail' song.album.pk %}" class="back-link">
        ← Volver al listado del álbum
    </a>
</div>

{% endblock %}